# Generated by Django 5.2.8 on 2026-01-20 05:02

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='KDFUser',
            fields=[
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('service_number', models.CharField(db_index=True, max_length=20, unique=True)),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('phone_number', models.CharField(max_length=15, unique=True, validators=[django.core.validators.RegexValidator(message='Enter valid Kenyan phone number', regex='^\\+254\\d{9}$')])),
                ('first_name', models.CharField(max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('national_id', models.CharField(max_length=20, unique=True)),
                ('date_of_birth', models.DateField()),
                ('rank', models.CharField(choices=[('PRIVATE', 'Private'), ('CORPORAL', 'Corporal'), ('SERGEANT', 'Sergeant'), ('LIEUTENANT', 'Lieutenant'), ('CAPTAIN', 'Captain'), ('MAJOR', 'Major'), ('COLONEL', 'Colonel'), ('BRIGADIER', 'Brigadier'), ('GENERAL', 'General')], max_length=20)),
                ('branch', models.CharField(choices=[('ARMY', 'Kenya Army'), ('NAVY', 'Kenya Navy'), ('AIR_FORCE', 'Kenya Air Force')], max_length=20)),
                ('unit', models.CharField(max_length=200)),
                ('specialization', models.CharField(blank=True, max_length=200)),
                ('enlistment_date', models.DateField()),
                ('status', models.CharField(choices=[('ACTIVE', 'Active Duty'), ('RESERVE', 'Reserve'), ('RETIRED', 'Retired'), ('SUSPENDED', 'Suspended')], default='ACTIVE', max_length=20)),
                ('is_two_factor_enabled', models.BooleanField(default=True)),
                ('phone_verified', models.BooleanField(default=False)),
                ('email_verified', models.BooleanField(default=False)),
                ('failed_login_attempts', models.IntegerField(default=0)),
                ('account_locked_until', models.DateTimeField(blank=True, null=True)),
                ('last_login_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('fingerprint_hash', models.CharField(blank=True, max_length=256)),
                ('face_recognition_hash', models.CharField(blank=True, max_length=256)),
                ('is_active', models.BooleanField(default=True)),
                ('is_staff', models.BooleanField(default=False)),
                ('date_joined', models.DateTimeField(default=django.utils.timezone.now)),
                ('last_updated', models.DateTimeField(auto_now=True)),
                ('clearance_level', models.IntegerField(default=1)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'db_table': 'kdf_users',
            },
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('action', models.CharField(choices=[('CREATE', 'Create'), ('UPDATE', 'Update'), ('DELETE', 'Delete'), ('VIEW', 'View'), ('EXPORT', 'Export'), ('LOGIN', 'Login'), ('LOGOUT', 'Logout'), ('PERMISSION_CHANGE', 'Permission Change')], max_length=30)),
                ('model_name', models.CharField(max_length=100)),
                ('object_id', models.CharField(max_length=100)),
                ('changes', models.JSONField(default=dict)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField()),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('flagged_suspicious', models.BooleanField(default=False)),
                ('ai_anomaly_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=3)),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'audit_logs',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='Equipment',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('equipment_code', models.CharField(max_length=50, unique=True)),
                ('name', models.CharField(max_length=300)),
                ('category', models.CharField(choices=[('WEAPONS', 'Weapons'), ('VEHICLES', 'Vehicles'), ('AIRCRAFT', 'Aircraft'), ('NAVAL', 'Naval Vessels'), ('COMMUNICATION', 'Communication Equipment'), ('MEDICAL', 'Medical Supplies'), ('AMMUNITION', 'Ammunition'), ('PROTECTIVE', 'Protective Gear')], max_length=20)),
                ('description', models.TextField()),
                ('quantity', models.IntegerField(default=1)),
                ('unit_cost', models.DecimalField(decimal_places=2, max_digits=15)),
                ('total_value', models.DecimalField(decimal_places=2, max_digits=15)),
                ('status', models.CharField(choices=[('OPERATIONAL', 'Operational'), ('MAINTENANCE', 'Under Maintenance'), ('DAMAGED', 'Damaged'), ('DECOMMISSIONED', 'Decommissioned')], default='OPERATIONAL', max_length=20)),
                ('current_location', models.CharField(max_length=300)),
                ('assigned_unit', models.CharField(blank=True, max_length=200)),
                ('last_maintenance', models.DateField(blank=True, null=True)),
                ('next_maintenance', models.DateField(blank=True, null=True)),
                ('ml_predicted_failure_date', models.DateField(blank=True, null=True)),
                ('ml_maintenance_priority', models.IntegerField(default=0)),
                ('acquired_date', models.DateField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_equipment', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'equipment',
                'ordering': ['category', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Incident',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('incident_number', models.CharField(max_length=50, unique=True)),
                ('incident_type', models.CharField(choices=[('SECURITY_BREACH', 'Security Breach'), ('BORDER_INCIDENT', 'Border Incident'), ('TERRORIST_ACTIVITY', 'Terrorist Activity'), ('CIVIL_UNREST', 'Civil Unrest'), ('NATURAL_DISASTER', 'Natural Disaster'), ('EQUIPMENT_FAILURE', 'Equipment Failure'), ('PERSONNEL_EMERGENCY', 'Personnel Emergency')], max_length=30)),
                ('title', models.CharField(max_length=300)),
                ('description', models.TextField()),
                ('location', models.CharField(max_length=300)),
                ('coordinates', models.CharField(blank=True, max_length=100)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], max_length=20)),
                ('casualties', models.IntegerField(default=0)),
                ('reported_at', models.DateTimeField(auto_now_add=True)),
                ('status', models.CharField(default='REPORTED', max_length=50)),
                ('resolved', models.BooleanField(default=False)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('ai_recommended_resources', models.JSONField(default=dict)),
                ('ai_estimated_response_time', models.IntegerField(blank=True, null=True)),
                ('ai_similar_incidents', models.JSONField(default=list)),
                ('images', models.JSONField(default=list)),
                ('after_action_report', models.TextField(blank=True)),
                ('reported_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='reported_incidents', to=settings.AUTH_USER_MODEL)),
                ('response_coordinator', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='coordinated_incidents', to=settings.AUTH_USER_MODEL)),
                ('response_team', models.ManyToManyField(blank=True, related_name='incident_responses', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'incidents',
                'ordering': ['-reported_at'],
            },
        ),
        migrations.CreateModel(
            name='LoginAttempt',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('service_number', models.CharField(max_length=20)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField()),
                ('successful', models.BooleanField(default=False)),
                ('failure_reason', models.CharField(blank=True, max_length=200)),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('location', models.CharField(blank=True, max_length=200)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='login_attempts', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'login_attempts',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='Mission',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('mission_code', models.CharField(max_length=50, unique=True)),
                ('title', models.CharField(max_length=300)),
                ('description', models.TextField()),
                ('classification', models.CharField(choices=[('UNCLASSIFIED', 'Unclassified'), ('CONFIDENTIAL', 'Confidential'), ('SECRET', 'Secret'), ('TOP_SECRET', 'Top Secret')], max_length=20)),
                ('status', models.CharField(choices=[('PLANNING', 'Planning'), ('APPROVED', 'Approved'), ('ACTIVE', 'Active'), ('COMPLETED', 'Completed'), ('ABORTED', 'Aborted')], default='PLANNING', max_length=20)),
                ('location', models.CharField(max_length=300)),
                ('coordinates', models.CharField(blank=True, max_length=100)),
                ('start_date', models.DateTimeField()),
                ('end_date', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('ai_threat_level', models.DecimalField(decimal_places=2, default=0.0, max_digits=3)),
                ('ai_risk_factors', models.JSONField(default=dict)),
                ('ai_recommendations', models.TextField(blank=True)),
                ('required_personnel_count', models.IntegerField()),
                ('allocated_budget', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('commander', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='commanded_missions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'missions',
                'ordering': ['-created_at'],
                'permissions': [('view_classified_missions', 'Can view classified missions'), ('approve_missions', 'Can approve missions')],
            },
        ),
        migrations.CreateModel(
            name='MissionAssignment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(choices=[('COMMANDER', 'Commander'), ('OFFICER', 'Officer'), ('SPECIALIST', 'Specialist'), ('SUPPORT', 'Support')], max_length=20)),
                ('assigned_date', models.DateTimeField(auto_now_add=True)),
                ('briefed', models.BooleanField(default=False)),
                ('mission', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='sentinel.mission')),
                ('personnel', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'mission_assignments',
            },
        ),
        migrations.AddField(
            model_name='mission',
            name='assigned_personnel',
            field=models.ManyToManyField(related_name='missions', through='sentinel.MissionAssignment', to=settings.AUTH_USER_MODEL),
        ),
        migrations.CreateModel(
            name='MLModel',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200)),
                ('model_type', models.CharField(choices=[('THREAT_PREDICTION', 'Threat Prediction'), ('ANOMALY_DETECTION', 'Anomaly Detection'), ('DEMAND_FORECAST', 'Demand Forecasting'), ('ROUTE_OPTIMIZATION', 'Route Optimization'), ('PATTERN_RECOGNITION', 'Pattern Recognition')], max_length=30)),
                ('version', models.CharField(max_length=20)),
                ('description', models.TextField()),
                ('accuracy', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('precision', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('recall', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('f1_score', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('is_active', models.BooleanField(default=False)),
                ('deployed_at', models.DateTimeField(blank=True, null=True)),
                ('last_trained', models.DateTimeField()),
                ('training_data_size', models.IntegerField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'ml_models',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SupplyChain',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('request_number', models.CharField(max_length=50, unique=True)),
                ('requesting_unit', models.CharField(max_length=200)),
                ('items', models.JSONField(default=list)),
                ('status', models.CharField(choices=[('REQUESTED', 'Requested'), ('APPROVED', 'Approved'), ('IN_TRANSIT', 'In Transit'), ('DELIVERED', 'Delivered'), ('CANCELLED', 'Cancelled')], default='REQUESTED', max_length=20)),
                ('priority', models.IntegerField(default=3)),
                ('requested_date', models.DateTimeField(auto_now_add=True)),
                ('approved_date', models.DateTimeField(blank=True, null=True)),
                ('delivery_date', models.DateTimeField(blank=True, null=True)),
                ('expected_delivery', models.DateTimeField(blank=True, null=True)),
                ('ml_optimal_route', models.JSONField(default=dict)),
                ('ml_estimated_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('ml_delivery_confidence', models.DecimalField(decimal_places=2, default=0.0, max_digits=3)),
                ('origin', models.CharField(max_length=300)),
                ('destination', models.CharField(max_length=300)),
                ('current_location', models.CharField(blank=True, max_length=300)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_supplies', to=settings.AUTH_USER_MODEL)),
                ('requested_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='supply_requests', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'supply_chain',
                'ordering': ['-requested_date'],
            },
        ),
        migrations.CreateModel(
            name='ThreatIntelligence',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=300)),
                ('description', models.TextField()),
                ('threat_type', models.CharField(max_length=100)),
                ('severity', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], max_length=20)),
                ('source', models.CharField(choices=[('HUMINT', 'Human Intelligence'), ('SIGINT', 'Signals Intelligence'), ('OSINT', 'Open Source Intelligence'), ('AI_DETECTED', 'AI System Detection'), ('CITIZEN_REPORT', 'Citizen Report')], max_length=20)),
                ('location', models.CharField(max_length=300)),
                ('coordinates', models.CharField(blank=True, max_length=100)),
                ('ai_confidence_score', models.DecimalField(decimal_places=2, max_digits=3)),
                ('ai_predicted_timeline', models.CharField(blank=True, max_length=200)),
                ('ai_related_threats', models.JSONField(default=list)),
                ('ml_pattern_match', models.JSONField(default=dict)),
                ('verified', models.BooleanField(default=False)),
                ('status', models.CharField(default='UNDER_INVESTIGATION', max_length=50)),
                ('detected_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('related_mission', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='sentinel.mission')),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_threats', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'threat_intelligence',
                'ordering': ['-detected_at'],
            },
        ),
        migrations.CreateModel(
            name='TwoFactorAuth',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=6)),
                ('method', models.CharField(choices=[('EMAIL', 'Email'), ('SMS', 'SMS'), ('AUTHENTICATOR', 'Authenticator App')], max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('expires_at', models.DateTimeField()),
                ('is_used', models.BooleanField(default=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='otp_codes', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'two_factor_auth',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='kdfuser',
            index=models.Index(fields=['service_number'], name='kdf_users_service_8c3ef8_idx'),
        ),
        migrations.AddIndex(
            model_name='kdfuser',
            index=models.Index(fields=['email'], name='kdf_users_email_240ff3_idx'),
        ),
        migrations.AddIndex(
            model_name='kdfuser',
            index=models.Index(fields=['status', 'branch'], name='kdf_users_status_7522cc_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['user', 'timestamp'], name='audit_logs_user_id_88267f_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['flagged_suspicious'], name='audit_logs_flagged_06e0ba_idx'),
        ),
        migrations.AddIndex(
            model_name='loginattempt',
            index=models.Index(fields=['user', 'timestamp'], name='login_attem_user_id_0ab626_idx'),
        ),
        migrations.AddIndex(
            model_name='loginattempt',
            index=models.Index(fields=['ip_address'], name='login_attem_ip_addr_0a65f5_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='missionassignment',
            unique_together={('mission', 'personnel')},
        ),
        migrations.AddIndex(
            model_name='threatintelligence',
            index=models.Index(fields=['severity', 'status'], name='threat_inte_severit_eaad64_idx'),
        ),
        migrations.AddIndex(
            model_name='threatintelligence',
            index=models.Index(fields=['detected_at'], name='threat_inte_detecte_7b8644_idx'),
        ),
    ]
